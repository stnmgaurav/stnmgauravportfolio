<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nam Jap Counter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <h1>ğŸ•‰ï¸ Nam Jap Counter</h1>

  <div id="circleContainer">
    <svg class="progress-ring" width="200" height="200">
      <circle
        class="progress-ring__circle"
        stroke="green"
        stroke-width="12"
        fill="transparent"
        r="90"
        cx="100"
        cy="100"
      />
    </svg>

    <!-- Mantra text (user can change this) -->
    <div id="mantra"></div>
  </div>

  <div id="countDisplay">Jap: 0 / 108</div>
  <div id="cycleCount">Cycles Completed: 0</div>

  <button id="changeMantraButton">Change Mantra</button>

  <footer>&copy; 2025 Naam Jap Counter</footer>

  <script>
    const MAX_COUNT = 108;
    let count = parseInt(localStorage.getItem("japCount")) || 0;
    let cycles = parseInt(localStorage.getItem("japCycles")) || 0;

    const countDisplay = document.getElementById("countDisplay");
    const cycleDisplay = document.getElementById("cycleCount");
    const mantraDisplay = document.getElementById("mantra");

    // Load saved mantra or default
    let mantra = localStorage.getItem("userMantra") || "à¥ à¤¨à¤®à¤ƒ à¤¶à¤¿à¤µà¤¾à¤¯";
    mantraDisplay.textContent = mantra;

    // Circle animation setup
    const circle = document.querySelector('.progress-ring__circle');
    const radius = circle.r.baseVal.value;
    const circumference = 2 * Math.PI * radius;

    circle.style.strokeDasharray = `${circumference}`;
    circle.style.strokeDashoffset = `${circumference}`;

    function setProgress(percent) {
      const offset = circumference - (percent / 100) * circumference;
      circle.style.strokeDashoffset = offset;
    }

    function updateDisplay() {
      countDisplay.textContent = `Jap: ${count} / ${MAX_COUNT}`;
      cycleDisplay.textContent = `Cycles Completed: ${cycles}`;
      const progressPercent = (count / MAX_COUNT) * 100;
      setProgress(progressPercent);
    }

    function incrementJap() {
      if (navigator.vibrate) navigator.vibrate(50); // vibration
      count++;
      if (count >= MAX_COUNT) {
        count = 0;
        cycles++;
        localStorage.setItem("japCycles", cycles);
      }
      localStorage.setItem("japCount", count);
      updateDisplay();
    }

    // Change Mantra Function
    document.getElementById("changeMantraButton").addEventListener("click", () => {
      const newMantra = prompt("Enter your mantra:", mantra);
      if (newMantra !== null && newMantra.trim() !== "") {
        mantra = newMantra.trim();
        localStorage.setItem("userMantra", mantra);
        mantraDisplay.textContent = mantra;
      }
    });

    // On click/touch anywhere on screen
    document.body.addEventListener("click", incrementJap);
    document.body.addEventListener("touchstart", incrementJap);

    // Initial load
    updateDisplay();
  </script>

</body>
</html>